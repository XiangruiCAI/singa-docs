# SINGA 架构

---

## 逻辑架构

<img src="../images/logical.png" style="width: 550px"/>
<p><strong> 图.1 - 系统逻辑架构</strong></p>

SINGA有一个灵活的架构，可以支持不同的分布式
[训练框架](frameworks.html) (包括同步的和异步的)。
系统的逻辑架构如图1所示，该架构包括多个服务器组和多个工作者组：

* **服务器组**
  服务器组会保有一份模型参数的完整复制，并负责处理来自工作者组的get/updata请求。
  相邻的服务器组会周期性的同步它们的参数。一般地，服务器组会包含一些服务器，每个服务器管理模型参数的一个划分。
* **工作者组**
  每个工作者组只和一个服务器组通信，工作者组在训练数据集的一个划分上训练一个完整的模型拷贝，
  并负责计算参数的梯度。
  所有的工作者组异步地与对应的工作者组通行和运行。但在每个工作者组内部，工作者同步地计算参数和更新模型。

可用以下策略分发组内工作者的训练负载：

  * **模型并行**. 在分给该工作者组的所有数据上，每个工作者计算一部分参数。
  * **数据并行**. 每个工作者在数据的子集上计算所有参数。
  * [**混合并行**](hybrid.html). SINGA也支持混合并行方式。


## 实现
在SINGA中，服务器和工作者是不同线程的执行单元，它们通过 [消息](communication.html) 进行通信。
每个进程的主线程作为根节点，负责聚合局部的消息并将其转发到对应的（远端的）接收者。

每个服务器组和工作者组有一个*ParamShard*对象，代表一个完整的模型拷贝。如果工作者和服务器在同一进程中，
他们的 *ParamShard* （划分） 会被配置到同一内存空间。在这种情况下，在不同执行单元间传输的消息仅包含数据的指针，
这样可以降低通信代价。在进程内通信时，消息必须包含参数值。
